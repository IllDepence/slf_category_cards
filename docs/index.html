<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  body {
    background-color: #fafafa;
  }
  #deck {
    grid-column: 1;
    grid-row: 1;
  }
  .card_container {
    width: 389px;
    height: 100%;
    /**
     * compensate for height 100% taking up
     * the 5px grid gap for some reason
     */
    margin-bottom: -5px;
    /**
     * makes .card_hover position absolute
     * word relative to container instead
     * of relative to some element higher
     * up the DOM
     */
    position: relative;
  }
  .card_hover_basic {
    width: 389px;
    height: 420px;
    position: absolute;
    top: 15%;
    opacity: 0;
    z-index: 999;
    background-color: #555;
    transition: .5s ease;
  }
  .card_hover_active:hover {
    opacity: 0.6;
  }
  .card_text {
    color: #fff;
    text-align: center;
    padding: 25px;
    font-size: 1.5em;
    font-family: sans-serif;
    text-shadow: #000 0 0 5px;
  }
  .card_cat {
    font-size: 1.2em;
    font-weight: 500;
  }
  /* default 3 columns */
  #card_grid {
    width: 1177px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(3, 389px);
    gap: 5px;
    transform-style: preserve-3d;
    transition: transform 0.5s; }
  /* two columns for screens narrower than (width of 3 cols + 10px) */
  @media screen and (max-width: 1190px) {
    #card_grid {
      width: 783px;
      grid-template-columns: repeat(2, 389px);
    }
  }
  /* single column for screens narrower than (width of 2 cols + 10px) */
  @media screen and (max-width: 803px) {
    #card_grid {
      width: 389px;
      grid-template-columns: repeat(1, 389px);
    }
  }
  /* shrinked single column for screens smaller than img with */
  @media screen and (max-width: 399px) {
    #card_grid {
      width: 100%;
      grid-template-columns: repeat(1, 100%);
    }
    #card_grid img {
      width: 100%;
      height: auto;
    }
  }
  </style>
</head>
<body>
  <div id="card_grid">
    <img id="deck" src="card_imgs_600px/karte_back.png">
  </div>
</body>

<script>
cats = [
  { id: 'behaelter', name: 'Behälter', valid: 'Becher, Rucksack, Container', invalid: 'Mund, Samsonite-Koffer, Zimmer' },
  //{ id: 'berg', name: '', valid: '', invalid: '' },
  { id: 'berg2', name: 'Berg', valid: 'Mount Everest, Kilimandscharo, Matterhorn', invalid: 'Bratpfannenberg, Himalaya, Schicksalsberg' },
  //{ id: 'berg3', name: '', valid: '', invalid: '' },
  //{ id: 'beruf', name: '', valid: '', invalid: '' },
  //{ id: 'beruf2', name: '', valid: '', invalid: '' },
  { id: 'beruf3', name: 'Beruf', valid: 'Gärtner, Polizist, Lehrer', invalid: 'Azubi, Marienkäferzüchter, Rentner' },
  { id: 'buch', name: 'Buch', valid: 'Die Bibel, Hamlet, Alice im Wunderland', invalid: 'Kindle, New York Times, Zur Elektrodynamik bewegter Körper' },
  { id: 'chem_element', name: 'Chemisches Element', valid: 'Wasserstoff, Helium, Eisen', invalid: 'Messing, Unobtainium, Wasser' },
  //{ id: 'chem_element2', name: '', valid: '', invalid: '' },
  { id: 'etw_das_fliegt', name: 'Etwas das Fliegt', valid: 'Biene, Flugzeug, Komet', invalid: 'Boeing 747, Magnet, Apfel' },
  //{ id: 'etw_das_fliegt2', name: '', valid: '', invalid: '' },
  { id: 'etw_rundes', name: 'Etwas Rundes', valid: 'Kokosnuss, Perle, Globus', invalid: 'Pringlesdose, Schlange, Schutzschild' },
  //{ id: 'etw_rundes2', name: '', valid: '', invalid: '' },
  { id: 'fiktives_werk', name: 'Fiktives Werk', valid: 'Star Wars, Krieg und Frieden, Pokemon', invalid: 'Eine kurze Geschichte der Zeit, Heiliger Krieg, Tagesschau' },
  { id: 'fluessigkeit', name: 'Flüssigkeit', valid: 'Wasser, Benzin, Tinte', invalid: 'Apfelsaft, Pepsi, Stickstoff' },
  { id: 'fluss', name: 'Fluss', valid: 'Donau, Nil, Amazonas', invalid: 'Golfstrom, Niagarafälle, Panamakanal' },
  { id: 'forbewegungsmittel', name: 'Fortbewegungsmittel', valid: 'Fahrrad, Auto, Flugzeug', invalid: 'Jeep, Mitfahrgelegenheit, Uber' },
  { id: 'gebaeude', name: 'Gebäudeart', valid: 'Wohnhaus, Bahnhof, Wolkenkratzer', invalid: 'Pentagon, Wohnsieldung, Designerhaus' },
  { id: 'gestein', name: 'Gesteinsart', valid: 'Marmor, Smaragd, Kohle', invalid: 'Beton, Fels, Kiesel' },
  { id: 'gruppenbezeichnung', name: 'Gruppenbezeichnung', valid: 'Paar, Duo, Bande', invalid: 'Al-Qaida, ABBA, Bundesregierung' },
  //{ id: 'gruppenbezeichnung2', name: '', valid: '', invalid: '' },
  { id: 'himmelskoerper', name: 'Himmelskörper', valid: 'Mars, Mond, Milchstraße', invalid: 'Wolke, Gasriese, Schwarzes Loch' },
  { id: 'kleidung', name: 'Kleidungsstück', valid: 'Jogginghose, Strohhut, Schal', invalid: 'Superman-Kostüm, Rammstein-T-Shirt, Ziegenfell-Jacke' },
  { id: 'krankheit', name: 'Krankheit', valid: 'Malaria, Krebs, Lepra', invalid: 'Juckreiz, Knochenbruch, Rücken' },
  //{ id: 'land', name: '', valid: '', invalid: '' },
  { id: 'land2', name: 'Land', valid: 'Deutschland, Mexiko, Japan', invalid: 'Afrika, Holland, Narnia' },
  { id: 'marke', name: 'Marke', valid: 'Apple, Gucci, Lego', invalid: 'Macintosh, Oscorp, Passat' },
  { id: 'naturphaenomen', name: 'Naturphänomen', valid: 'Regen, Donner, Nordlicht', invalid: 'Schwerkraft, Smog, Tiere' },
  { id: 'naturkatastrophe', name: 'Naturkatastrophe', valid: 'Erdbeben, Hurrikan, Tsunami', invalid: 'Regen, Weltuntergang, Asteroid' },
  //{ id: 'naturkatastrophe2', name: '', valid: '', invalid: '' },
  //{ id: 'naturkatastrophe3', name: '', valid: '', invalid: '' },
  //{ id: 'naturkatastrophe4', name: '', valid: '', invalid: '' },
  { id: 'pflanze', name: 'Pflanze', valid: 'Rose, Ahorn, Hagebutte', invalid: 'Ent, Koralle, Peitschende Weide' },
  { id: 'promi', name: 'Prominente Person', valid: 'Albert Einstein, Marilyn Monroe, Edward Snowden', invalid: 'Krusty, Sherlock Holmes, Tony Stark' },
  { id: 'spiel', name: 'Spiel', valid: 'Schach, Poker, Monopoly', invalid: 'Lego, Telefonstreich, Weitsprung' },
  { id: 'sport', name: 'Sportart', valid: 'Fußball, Tennis, Boxen', invalid: 'Leichtathletik, Podrennen, Wettessen' },
  { id: 'sprache', name: 'Sprache', valid: 'Deutsch, Englisch, Spanisch', invalid: 'Bolivianisch, Indisch, Plattdeutsch' },
  { id: 'stadt', name: 'Stadt', valid: 'Berlin, New York, Shanghai', invalid: 'Minas Tirith, Coruscant, Alabastia' },
  { id: 'straftat', name: 'Straftat', valid: 'Dienbstahl, Mord, Steuerhinterziehung', invalid: 'Bananen-Diebstahl, Lügen, Supermarkt-Einbruch' },
  { id: 'stromquelle', name: 'Stromquelle', valid: 'elektrischer Aal, Dynamo, Batterie', invalid: 'Duracell, Ladekabel, Flux-Kondensator' },
  { id: 'tierfaehigkeit', name: 'Tierische Fähigkeit', valid: 'Fliegen, Echolokation, Biolumineszenz', invalid: 'Feuerspeien, Unsichtbarkeit, Laufen' },
  //{ id: 'tier', name: '', valid: '', invalid: '' },
  { id: 'tier2', name: 'Tier', valid: 'Katze, Adler, Spinne', invalid: 'Einhorn, Drache, Phönix' },
  { id: 'waehrung', name: 'Währung', valid: 'Euro, US-Dollar, Rubel', invalid: 'Credits, Goldstücke, Scheine' },
  { id: 'waffe', name: 'Waffe', valid: 'Schwert, Pistole, Bombe', invalid: 'Faust, Glasscherbe, Stift' },
  { id: 'werkzeug', name: 'Werkzeug', valid: 'Hammer, Zange, Feile', invalid: 'Bosch-Flex, Hand, Leatherman' },
  { id: 'zeitspanne', name: 'Zeitspanne', valid: 'Sekunde, Quartal, Dekade', invalid: 'Gestern, Mathestunde, Selbstfindungsphase' }
  //{ id: 'zeitspanne2', name: '', valid: '', invalid: '' },
]

/**
 * idea for more realistic animation
 * - set deck z-index to 999 (= topmost)
 * - manage grid position of cards manually in JS
 * - slide cards out from under the deck
 * - slide cards from deck to right,
 *   from rightmost column down
 *   then left etc.
 *   D--->---v
 *   v---<---<
 *   >---> ...
 */

// create click listener on the card deck to draw cards
document.getElementById('deck').addEventListener('click', function() {
  var grid = document.getElementById('card_grid');
  // get random category and remove it from the list
  var cat = cats[Math.floor(Math.random() * cats.length)];
  cats.splice(cats.indexOf(cat), 1);
  // if no more cards are left, remove the deck
  if (cats.length == 0) {
    document.getElementById('deck').remove();
  }
  // pre-load card_front image
  card_src = 'card_imgs_600px/karte_' + cat['id'] + '.png';
  var img = new Image();
  img.src = card_src;
  // create new card (back first)
  card_back_src = 'card_imgs_600px/karte_back.png';
  var card_back = document.createElement('img');
  card_back.src = card_back_src;
  // insert card back into the grid
  if (cats.length == 0) {
    grid.insertBefore(card_back, grid.children[0]);
  } else if (grid.children.length == 1) {
    grid.appendChild(card_back);
  } else {
    grid.insertBefore(card_back, grid.children[1]);
  }
  // first half of card flip
  card_back.style.transformStyle = 'preserve-3d';
  card_back.style.transform = 'rotateY(0deg)';
  card_back.style.transition = 'transform 0.5s';
  setTimeout(() => {
      card_back.style.transform = 'rotateY(90deg)';
  }, 50);
  setTimeout(() => {
      card_back.remove();
  }, 550);
  // second half of card flip
  // create card_ container and hover
  var card_cntnr = document.createElement('div');
  card_cntnr.className = "card_container";
  var card_hvr = document.createElement('div');
  card_hvr.className = "card_hover_basic";
  card_hvr.innerHTML = ``
    + `<div class="card_text">`
    +   `<span class="card_cat">${cat['name']}</span><br><br>`
    +   `<strong>gültig</strong><br>${cat['valid']}<br><br>`
    +   `<strong>ungültig</strong><br>${cat['invalid']}`
    + `</div>`;
  var card = document.createElement('img');
  card.src = card_src;
  card.style.transformStyle = 'preserve-3d';
  card.style.transform = 'rotateY(-90deg)';
  card.style.transition = 'transform 0.5s';
  card_cntnr.appendChild(card_hvr);
  card_cntnr.appendChild(card);
  setTimeout(() => {
      if (cats.length == 0) {
        grid.insertBefore(card_cntnr, grid.children[0]);
      } else if (grid.children.length == 1) {
        grid.appendChild(card_cntnr);
      } else {
        grid.insertBefore(card_cntnr, grid.children[1]);
      }
      setTimeout(() => {
          card.style.transform = 'rotateY(0deg)';
      }, 50);
      setTimeout(() => {
          card_hvr.classList.add('card_hover_active');
      }, 500);
  }, 550);
});
</script>
<html>
